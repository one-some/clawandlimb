[gd_scene load_steps=31 format=3 uid="uid://bysjxpr0tkfu1"]

[ext_resource type="Script" uid="uid://cwhm2cwafg7eo" path="res://camera.gd" id="1_0xm2m"]
[ext_resource type="Script" uid="uid://bcjfwo7l0utc2" path="res://build.gd" id="1_ig7tw"]
[ext_resource type="Script" uid="uid://cxshea2chitxj" path="res://main.gd" id="1_kek77"]
[ext_resource type="Script" uid="uid://dmjjygs0kqee" path="res://grid_map.gd" id="3_h2yge"]
[ext_resource type="Script" uid="uid://upjcky65nrwn" path="res://player.gd" id="4_1bvp3"]
[ext_resource type="Script" uid="uid://cwuwe30qn7rkj" path="res://world.gd" id="4_272bh"]
[ext_resource type="Texture2D" uid="uid://bxsgub1p3jt2c" path="res://tex/freakingnatuto.png" id="5_lquwl"]
[ext_resource type="PackedScene" uid="uid://bjkfgco15fjsp" path="res://mdl/Axe.gltf" id="6_4c57u"]
[ext_resource type="Script" uid="uid://dud76iv7grm4b" path="res://resources.gd" id="6_7mycd"]
[ext_resource type="Script" uid="uid://b55h5ok8v2s5s" path="res://hand.gd" id="6_efxa6"]
[ext_resource type="Script" uid="uid://c7imyrbfwguwo" path="res://equipable_item.gd" id="8_w48qg"]
[ext_resource type="PackedScene" uid="uid://0fc3n5w2os8h" path="res://ui.tscn" id="12_dg77c"]
[ext_resource type="Script" uid="uid://b3wmymcs1xnik" path="res://item_container.gd" id="12_ycdy4"]
[ext_resource type="Shader" uid="uid://deusiyboy5f8r" path="res://grid.gdshader" id="14_vivmo"]
[ext_resource type="Script" uid="uid://bx3ft4mal7bir" path="res://enemies.gd" id="15_2cqfq"]

[sub_resource type="PhysicalSkyMaterial" id="PhysicalSkyMaterial_5vw27"]
rayleigh_coefficient = 1.0
rayleigh_color = Color(0.419271, 0.622526, 1, 1)
mie_color = Color(0.888021, 0.797036, 0.52495, 1)
energy_multiplier = 2.0

[sub_resource type="Sky" id="Sky_1bvp3"]
sky_material = SubResource("PhysicalSkyMaterial_5vw27")

[sub_resource type="Environment" id="Environment_lquwl"]
background_mode = 2
sky = SubResource("Sky_1bvp3")
ambient_light_color = Color(0.633757, 0.633757, 0.633757, 1)
ambient_light_sky_contribution = 0.3
reflected_light_source = 2
ssao_intensity = 16.0
volumetric_fog_density = 0.0001
adjustment_enabled = true

[sub_resource type="CapsuleMesh" id="CapsuleMesh_1bvp3"]
radius = 0.3

[sub_resource type="ConvexPolygonShape3D" id="ConvexPolygonShape3D_7mycd"]
points = PackedVector3Array(0.267016, 0.766948, -0.1164, -0.291458, -0.761872, -0.0276713, -0.291252, -0.761336, 0.0307681, 0.268404, -0.800496, -0.0873515, 0.0595203, 0.725185, 0.291707, -0.142914, 0.751361, -0.258503, 0.176354, -0.757722, 0.234724, 0.0307677, -0.761328, -0.291249, -0.260518, 0.78619, 0.118015, -0.142848, -0.722061, 0.261502, 0.266301, 0.764882, 0.119199, -0.119879, -0.971825, 0.0318498, 0.145392, 0.748031, -0.257351, 0.0923368, 0.96888, 0.0923368, -0.196733, -0.708295, -0.22508, -0.286001, 0.718859, -0.0846668, -0.142848, 0.722061, 0.261502, 0.291707, -0.725185, 0.0595203, -0.0287456, 0.972175, -0.119923, 0.198947, -0.676966, -0.224046, -0.0565014, -0.726422, 0.292202, 0.0923368, -0.96888, 0.0923368, -0.0585673, -0.932875, -0.178936, -0.248347, -0.638684, 0.16812, 0.0307681, 0.761336, -0.291252, 0.225451, 0.671658, 0.1974, -0.148495, 0.930441, 0.121583, -0.0846668, -0.718859, -0.286001, 0.292202, 0.726422, -0.0565014, -0.207688, 0.896906, -0.0880939, 0.121583, -0.930441, -0.148495, -0.0878682, -0.894648, 0.210278)

[sub_resource type="BoxShape3D" id="BoxShape3D_7mycd"]
size = Vector3(2.235, 1, 1)

[sub_resource type="Animation" id="Animation_4c57u"]
resource_name = "AxeChop"
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Hand/WoodenAxe/Model:rotation")
tracks/0/interp = 2
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.233333, 0.7, 1),
"transitions": PackedFloat32Array(1, 1, 1, 1),
"update": 0,
"values": [Vector3(0, 0, 0), Vector3(-0.211261, -0.525508, 0.207511), Vector3(-0.219205, -0.430524, 0.309511), Vector3(0.0925025, 1.90764, 1.28631)]
}
tracks/1/type = "method"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("Hand")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0.9),
"transitions": PackedFloat32Array(1),
"values": [{
"args": [],
"method": &"_at_mid_swing"
}]
}

[sub_resource type="Animation" id="Animation_efxa6"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Hand/WoodenAxe/Model:rotation")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector3(0, 0, 0)]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_efxa6"]
_data = {
&"AxeChop": SubResource("Animation_4c57u"),
&"RESET": SubResource("Animation_efxa6")
}

[sub_resource type="FastNoiseLite" id="FastNoiseLite_vivmo"]

[sub_resource type="NavigationMesh" id="NavigationMesh_vivmo"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_2cqfq"]
render_priority = 0
shader = ExtResource("14_vivmo")
shader_parameter/gridlineOnEvery = 1.0
shader_parameter/lineThickness = 0.05
shader_parameter/originOffset = Vector2(0, 0)
shader_parameter/color = Color(1, 1, 1, 0.298039)
shader_parameter/pointer = Vector2(0, 0)

[sub_resource type="PlaneMesh" id="PlaneMesh_yaehf"]
material = SubResource("ShaderMaterial_2cqfq")
size = Vector2(24, 24)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_7mycd"]
transparency = 1
shading_mode = 0
albedo_color = Color(1, 0, 0, 0.486275)

[sub_resource type="SphereMesh" id="SphereMesh_272bh"]
radius = 0.2
height = 0.4

[node name="Main" type="Node3D"]
script = ExtResource("1_kek77")

[node name="Camera3D" type="Camera3D" parent="."]
unique_name_in_owner = true
transform = Transform3D(0.707107, -0.5, 0.5, 0, 0.707107, 0.707107, -0.707107, -0.5, 0.5, 5, 5, 5)
fov = 70.0
script = ExtResource("1_0xm2m")

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_lquwl")

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="."]
transform = Transform3D(1, 0, 0, 0, -0.412755, 0.910842, 0, -0.910842, -0.412755, 0, 0, 0)
shadow_enabled = true

[node name="Player" type="CharacterBody3D" parent="."]
unique_name_in_owner = true
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 4.07693, 4.53789, 6.3614)
script = ExtResource("4_1bvp3")

[node name="MeshInstance3D" type="MeshInstance3D" parent="Player"]
visible = false
mesh = SubResource("CapsuleMesh_1bvp3")

[node name="CollisionShape3D" type="CollisionShape3D" parent="Player"]
shape = SubResource("ConvexPolygonShape3D_7mycd")

[node name="Naruto" type="Sprite3D" parent="Player"]
pixel_size = 0.003
billboard = 2
shaded = true
texture_filter = 0
texture = ExtResource("5_lquwl")

[node name="ShapeCast3D" type="ShapeCast3D" parent="Player"]
shape = SubResource("BoxShape3D_7mycd")
target_position = Vector3(0, 0, 1)

[node name="AnimationPlayer" type="AnimationPlayer" parent="Player"]
libraries = {
&"": SubResource("AnimationLibrary_efxa6")
}

[node name="Hand" type="Node3D" parent="Player"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.300949, 0, 0.0446992)
script = ExtResource("6_efxa6")

[node name="WoodenAxe" type="Node3D" parent="Player/Hand"]
script = ExtResource("8_w48qg")
item_id = "wooden_axe"
metadata/_custom_type_script = "uid://c7imyrbfwguwo"

[node name="Model" parent="Player/Hand/WoodenAxe" instance=ExtResource("6_4c57u")]

[node name="World" type="Node3D" parent="."]
unique_name_in_owner = true
script = ExtResource("4_272bh")
noise = SubResource("FastNoiseLite_vivmo")

[node name="GridMap" type="GridMap" parent="World" groups=["NavigationObstacle"]]
cell_size = Vector3(1, 1, 1)
collision_layer = 17
script = ExtResource("3_h2yge")

[node name="Resources" type="Node3D" parent="World"]
script = ExtResource("6_7mycd")

[node name="Build" type="Node3D" parent="World"]
unique_name_in_owner = true
script = ExtResource("1_ig7tw")

[node name="Items" type="Node3D" parent="World"]
script = ExtResource("12_ycdy4")

[node name="Navigation" type="Node3D" parent="World"]

[node name="NavigationRegion3D" type="NavigationRegion3D" parent="World"]
navigation_mesh = SubResource("NavigationMesh_vivmo")

[node name="BuildGrid" type="MeshInstance3D" parent="."]
unique_name_in_owner = true
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.501, 0)
visible = false
mesh = SubResource("PlaneMesh_yaehf")
skeleton = NodePath("../World")

[node name="3DCursor" type="MeshInstance3D" parent="."]
unique_name_in_owner = true
material_override = SubResource("StandardMaterial3D_7mycd")
mesh = SubResource("SphereMesh_272bh")

[node name="Enemies" type="Node3D" parent="."]
script = ExtResource("15_2cqfq")

[node name="SpawnTimer" type="Timer" parent="Enemies"]
autostart = true

[node name="CanvasLayer" type="CanvasLayer" parent="."]

[node name="UI" parent="CanvasLayer" instance=ExtResource("12_dg77c")]

[connection signal="timeout" from="Enemies/SpawnTimer" to="Enemies" method="_on_spawn_timer_timeout"]
